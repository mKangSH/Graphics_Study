## 설명자 힙 (Descriptor Heap)
- 대량의 메모리 할당량을 포함하는 용도
  - 셰이더에서 최대한 많은 렌더링 창으로 참조하는 개체 형식의 설명자 사양을 저장하는 데 필요 
  - API를 통해 텍스처를 빠르게 전환하는 경우 즉석에서 모든 상태에 대해 설명자 테이블을 정의하는 데 필요
- 모든 힙은 CPU에 표시, 설명자 힙에 필요한 CPU 엑세스 속성 쿼리 가능
- 일반 리소스용, 샘플러용의 두 가지 설명자 힙 세트를 가짐
- 설명자가 활성 상태인 경우 주소 지정 비트만으로 힙을 사용 가능
- 명령 목록의 기록 전, 도중, 후에 설명자 힙 콘텐츠를 변경 가능
  - 실행을 위해 제출된 명령 목록에서 참조 가능성이 있다면 변경 불가
    - 경합 상태가 발생할 수 있음
- 한 번에 하나의 CBV/SRV/UAV 힙과 하나의 샘플러 힙만 바인딩 가능
- API를 통해 힙을 전환할 수 있지만 일부 하드웨어에선 GPU 정지를 해야하기 때문에 많은 비용이 발생 가능
  - GPU 워크로드 양이 적은 경우에만 작업하는 게 유리
- 셰이더 표시 설명자 힙의 최대 샘플러 수는 2048개
- 라이브 루트 서명에서 고유한 정적 샘플러의 최대 개수 2032개
  - 자체 샘플러가 드라이버 전용으로 16개를 사용
- CPU에서 쓰기 가능한 GPU 로컬 메모리(쓰기 결합 메모리) 양에 대한 GPU 하드웨어 제한이 존재
- IBV, VBV, SOV는 API에 직접 전달되며, 힙 형식이 없음

## 설명자 테이블
- 설명자 힙에 대한 오프셋 및 길이
- 설명자 테이블에 설명자 형식(SRV, UAV, CBV, etc)의 설명자가 저장
- 그래픽 파이프라인은 루트 서명을 통해 인덱스별로 테이블 참조하여 엑세스 권한 획득
- 루트 서명: 힙 참조->테이블 시작 위치->테이블 길이 획득->설명자 테이블 항목 참조
- 설명자 테이블 내에서 설명자를 선택하면 셰이더 코드에서 동적으로 인덱싱 가능
- 설명자 테이블을 설정하는 명령 목록에 대한 참조 사용이 끝날 때까지 GPU가 참조할 가능성이 있는 설명자 힙 부분 편집 지양
  - API 펜스 또는 디스플레이로 렌더링 전송 완료가 확인될 때까지 기다리는 방식을 통해 GPU 참조 완료 상태 확인
- 렌더링 호출 도중 참조하지 않는 다른 설명자 변경 가능
    - 설명자 테이블 버전 관리
    - 동적 인덱싱
    - 루트 서명에서 직접 설명자 추가

## 셰이더 표시 설명자 힙
- 특정 형식의 설명자 힙을 만들 때, 셰이더 표시로 설정
    - D3D12_SRV_UAV_CBV_DESCRIPTOR_HEAP
    - D3D12_DESCRIPTOR_HEAP_TYPE_SAMPLER
- 개별 설명자 힙 할당에 대한 하드웨어 크기 제한 존재 가능
- 큰 기본 설명자 힙에서 설명자 힙을 하위 할당 가능
  - 하드웨어 크기 제한보다 작은 경우 
  - 여러 API 설명자 힙이 하나의 하드웨어 설명자 힙으로 종속
  - 일부 하드웨어는 하드웨어 실행 중 하드웨서 설명자 힙 간 전환이 가능한지 확인하기 위해 GPU 대기가 필요

## 셰이더 비표시 설명자 힙
- CPU에서 설명자를 스테이징할 때 응용 프로그램을 지원하기 유용
- RTV, DSV는 항상 셰이더 비표시로 존재
  - 명령 목록에 직접 콘텐츠를 기록하여 파이프라인에 바인딩 하는 설명자
- 명령 목록에 기록한 후에 대한 호출에서 설명자를 포함하는 데 사용되는 메모리는 즉시 재사용 가능

## 설명자 힙 생성
```
// type : enum
D3D12_DESCRIPTOR_HEAP_TYPE {heap type};

D3D12_DESCRIPTOR_HEAP_DESC {heap descriptor};
// populate descriptor 
{
    {heap descriptor}.NumDescriptor = ...;
    ...;
}

{pointer to device}->CreateDescriptorHeap(
    &{heap descriptor}
    &{pointer to heap} // interface
);
```
